# 敏捷反馈

很多项目，都是因为程序代码失控而陷入困境。修复bug导致了更多的bug，从而又导致了更多的bug修复，成堆的测试卡片最后会把项目压垮。

这时，我们需要的是经常的监督——频繁反馈以确保代码不会变坏，如果不会更好，至少能像昨天一样继续工作。



## 习惯建议：
### 跟踪变化
> 拒绝诱惑
- 诱惑魔鬼：“你不必为单元测试花费那么多时间和精力。它只会拖延项目的进度。好歹，你也是一个不错的程序员——单元测试只会浪费时间，我们现在正处于关键时刻。” 
    - 如果只是掌握了工作中需要的技术并不够。那样的工作也许几年之后就不再有了——它会被外包或者会过时，那么你也将会出局。
- 守护天使：“使用自动化的单元测试。好的单元测试能够为你的代码问题提供及时的警报。如果没有到位的单元测试，不要进行任何设计和代码修改。”
    - 确保测试是可重复的。
    - 测试你的边界条件。
    - 不要放过任何一个失败的测试。

> 切身感受：你依赖于单元测试。如果代码没有测试，你会觉得很不舒服，就像是在高空作业没有系安全带一样。

> 平衡艺术：
- 测试帮助你全面思考代码的行为，帮你练习正面、反面以及异常情况。
- 单元测试有助于实现简单的、注重实效的设计。
- 单元测试是让你自信的后台。 
- 单元测试是解决问题时的探测器。
- 单元测试是可信的文档。
- 单元测试是学习工具。
- 单元测试让你的代码更加健壮。
- 单元测试能及时提供反馈。


### 先用它再实现它
> 拒绝诱惑
- 诱惑魔鬼：“前进，先完成所有的库代码。后面会有大量时间看用户是如何思考的。现在只要把代码扔过墙去就可以了，我保证它没有问题。” 
    - 如果不是真正需要它的时候，你就不应该实现这个功能。
- 守护天使：“先用它再实现它。将TDD作为设计工具，它会为你带来更简单更有实效的设计。”

> 切身感受：这种感觉就是，只在有具体理由的时候才开始编码。你可以专注于设计接口，而不会被很多实现的细节干扰。

> 平衡艺术：
- 单纯的单元测试无法保证好的设计，但它们会对设计有帮助，会让设计更加简单。


### 不同环境，就有不同问题 
> 拒绝诱惑
- 诱惑魔鬼：“只要代码能在你的机器上运行就可以了，谁会去关心它是否可以在其他平台上工作。你又不用其他平台。”
    - 与没有文档的内部操作系统纠缠在一起，绝对是非常脆弱的。
- 守护天使：“不同环境，就有不同问题。使用持续集成工具，在每一种支持的平台和环境中运行单元测试。要积极地寻找问题，而不是等问题来找你。”

> 切身感受：感觉就像是在做单元测试，非但如此，而且还是跨越不同的世界的单元测试。

> 平衡艺术：
- 硬件比开发人员的时间便宜。但如果你有很多配置，要支持大量的平台，可以选择哪些平台需要内部测试。


### 自动验收测试 
> 拒绝诱惑
- 诱惑魔鬼：“很好，你现在用单元测试来验证代码是否完成了你期望的行为。发给客户吧。我们很快会知道这是否是用户期望的功能。”
    - 关键业务逻辑必须要独立进行严格的测试，并且最后需要通过用户的审批。
- 守护天使：“为核心的业务逻辑创建测试。让你的客户单独验证这些测试，要让它们像一般的测试一样可以自动运行。”
    - FIT，即集成测试框架，它很实用，可以更容易地使用HTML表格定义测试用例，并比较测试结果数据。

> 切身感受：它像是协作完成的单元测试：你仍然是在编写测试，但从其他人那里获得答案。

> 平衡艺术：
- 使用客户的业务逻辑，但是不要陷入无边无际的文档写作之中。 
- 不是所有客户都能给你提供正确的数据。如果他们已经有了正确的数据，就根本不需要新系统了。


### 度量真实的进度 
> 拒绝诱惑 
- 诱惑魔鬼：“用自己的时间表报告工作进度。我们会用它做项目计划。不用管那些实际的工作时间，每周填满40小时就可以了。”
    - 判断工作进度最好是看实际花费的时间而不是估计的时间。
- 守护天使：“度量剩下的工作量。不要用不恰当的度量来欺骗自己或者团队。要评估那些需要完成的待办事项。”
    - 我们不应该去计算工作量完成的百分比，而应该测定还剩下多少工作量没有完成。
    - 在为下一个任务估计工作量时，可以根据这次经验调整评估。如果你低估了一个任务，评估是2天，它最后花费了6天，那么系数就是3。除非是异常情况，否则你应该对下次估计乘以系数3。你的评估会波动一段时间，有时候过低估计，有时候过高估计。但随着时间的推移，你的评估会与事实接近，你也会对任务所花费的时间有更清楚的认识。
    - 如果能一直让下一步工作是可见的，会有助于进度度量。最好的做法就是使用待办事项（backlog）。通过代办事项，就可以随时知道下一步最重要的任务是什么。同时，你的评估技巧也在不停地改进，你也会越来越清楚完成一项任务要花费的时间。

> 切身感受：你会觉得很舒服，因为你很清楚哪些任务已经完成，哪些是没有完成的，以及它们的优先级。

> 平衡艺术：
- 关注功能，而不是日程表。 
- 一周工作40个小时，不是说你就有40个小时的编码时间。你需要减去会议、电话、电子邮件以及其他相关活动时间。


### 倾听用户的声音 
> 拒绝诱惑 
- 诱惑魔鬼：“用户就是会抱怨。这不是你的过错，是用户太愚蠢了，连使用手册都看不懂。它不是一个bug，只是用户不明白如何使用而已。他们本应该知道更多。” 
    - 当出了错误，你要尽可能提供详细信息。
- 守护天使：“每一个抱怨的背后都隐藏了一个事实。找出真相，修复真正的问题。”
    - 你不仅需要和真实用户（不是他们的经理，也不是业务分析师之类的代理人）进行交谈，还需要耐心地倾听。

> 切身感受：对客户的那些愚蠢抱怨，你既不会生气，也不会轻视。你会查看一下，找出背后真正的问题。

> 平衡艺术：
- 没有愚蠢的用户。   
- 只有愚蠢、自大的开发人员。





